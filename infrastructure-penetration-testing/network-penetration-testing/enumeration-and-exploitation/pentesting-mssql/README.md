# Pentesting MSSQL

## Initial Recon / Discovery&#x20;

### Using Nmap

**Confirm MSSQL Server is there**&#x20;

{% code overflow="wrap" %}
```bash
nmap -sS -Pn -n -p 1433 192.168.16.128 --script ms-sql-info,ms-sql-ntlm-info
```
{% endcode %}

<figure><img src="../../../../.gitbook/assets/image (1) (1).png" alt=""><figcaption></figcaption></figure>

**Good nmap scripts:**&#x20;

* **`ms-sql-info`**
  * Identify exact SQL Server version&#x20;
  * Tells Service pack level is RTM (Release to Manufacturing) which means it is first official release of the software and no update is applied later.&#x20;
  * Tells whether updates are applied or not after RTM. (`Post-SP patches applied`)
* **`ms-sql-ntlm-info`**
  * Tells that target server is connected to a domain.&#x20;
    * **Domain name:** _backontrack.local_
    * **Target Machine Name:** _DBSRV01_
    * _Using build number too we can fingerprint and identify the type of Operating system in use._&#x20;

### Using Metasploit&#x20;

<figure><img src="../../../../.gitbook/assets/image (2) (1).png" alt=""><figcaption></figcaption></figure>

_Microsoft SQL Server version 15.0.2000 corresponds to the initial Release to Manufacturing (RTM) build of **Microsoft SQL Server 2019**, released around November 2019._

## Enumeration&#x20;

### Basic Information&#x20;

#### _ms-sql-empty-password_

* _It test for “password policy disabled” because then only password can be empty._&#x20;

<figure><img src="../../../../.gitbook/assets/2026-02-08_121947.png" alt=""><figcaption></figcaption></figure>

## Brute Force&#x20;

Note that in MSSQL Server supports two type of authentication.

* Windows Authentication
* SQL Server Authentication

{% hint style="info" %}
_Don't forget to brute force both the type of authentication._
{% endhint %}

**Tools that can bruteforce both type of authentication**&#x20;

* _Metasploit_
* _Netexec / Crackmapexec / nxc_

**Tools that can bruteforce SQL Authentication only**&#x20;

* _Nmap_&#x20;
* _Hydra_

### Using Metasploit

**With Option (`USE_WINDOWS_AUTHENT`) set**

<figure><img src="../../../../.gitbook/assets/image (3) (1).png" alt=""><figcaption></figcaption></figure>

**With Option (`USE_WINDOWS_AUTHENT`) unset**

<figure><img src="../../../../.gitbook/assets/2026-02-08_133117.png" alt=""><figcaption></figcaption></figure>

### Using Netexec / Crackmapexec / nxc

<figure><img src="../../../../.gitbook/assets/image (4) (1).png" alt=""><figcaption></figcaption></figure>

### Using Nmap

* _**`ms-sql-brute`**: As the name suggests brute force the database. But we can do these with other tools as well._

<figure><img src="../../../../.gitbook/assets/2026-02-08_134258.png" alt=""><figcaption></figcaption></figure>

#### Using Hydra&#x20;

<figure><img src="../../../../.gitbook/assets/2026-02-08_133344.png" alt=""><figcaption></figcaption></figure>

## Credentialed-Enumeration&#x20;

